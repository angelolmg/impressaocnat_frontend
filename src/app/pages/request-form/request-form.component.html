<form class="my-steps">
	<h2 class="page-title">{{ pageState }}</h2>

	<div class="file-input">
		<p>1. Escolha seu arquivo (.pdf)</p>
		<button type="button" mat-stroked-button (click)="fileInput.click()">
			Escolher arquivo...
		</button>
		<input
			hidden
			(change)="onFileSelected($event)"
			#fileInput
			type="file"
			accept="application/pdf"
		/>
		<span class="file-name">{{ selectedFile?.name }}</span>
	</div>

	<div class="copynum-input">
		<p>2. Defina o número de cópias</p>
		<mat-form-field>
			<mat-label>Número de cópias</mat-label>
			<input
				matInput
				type="number"
				class="copy-number-input"
				[formControl]="copyNumFormControl"
				[errorStateMatcher]="matcher"
				placeholder="Ex. 10"
			/>
			<!-- <mat-hint>Errors appear instantly!</mat-hint> -->
			@if (copyNumFormControl.hasError('min') &&
			!copyNumFormControl.hasError('required')) {
			<mat-error>Insira um valor positivo</mat-error>
			} @if (copyNumFormControl.hasError('required')) {
			<mat-error>Campo <strong>obrigatório</strong></mat-error>
			}
		</mat-form-field>
	</div>

	<div class="btn-selection">
		<button type="button" mat-flat-button>Adicionar arquivo</button>
		<button type="button" mat-button>Limpar</button>
	</div>

	<div class="file-table">
		<table
			mat-table
			[dataSource]="dataSource"
			matSort
			class="mat-elevation-z8"
		>
			<ng-container matColumnDef="id">
				<th mat-header-cell *matHeaderCellDef>ID</th>
				<td mat-cell *matCellDef="let element">
					{{ element.id.toString().padStart(6, "0") }}
				</td>
			</ng-container>

			<ng-container matColumnDef="file_name">
				<th mat-header-cell *matHeaderCellDef style="width: 50%">
					Arquivo
				</th>
				<td mat-cell *matCellDef="let element" style="width: 50%">
					{{ element.file_name }}.{{ element.file_extension }}
				</td>
			</ng-container>

			<ng-container matColumnDef="page_count">
				<th mat-header-cell *matHeaderCellDef>Páginas</th>
				<td mat-cell *matCellDef="let element">
					{{ element.page_count }}
				</td>
			</ng-container>

			<ng-container matColumnDef="copy_count">
				<th mat-header-cell *matHeaderCellDef>Nº Cópias</th>
				<td mat-cell *matCellDef="let element">
					{{ element.copy_count }}
				</td>
			</ng-container>

			<ng-container class="center-elements" matColumnDef="actions">
				<th mat-header-cell *matHeaderCellDef>Ações</th>

				<td mat-cell *matCellDef="let element">
					@if (pageState == 'Editar Solicitação') {

					<button
						mat-icon-button
						matTooltip="Editar"
						aria-label="Editar cópia"
						(click)="editCopy(element)"
					>
						<mat-icon>edit</mat-icon>
					</button>
					}

					<button
						mat-icon-button
						matTooltip="Remover"
						aria-label="Remover cópia"
						(click)="removeCopy(element)"
					>
						<mat-icon>delete</mat-icon>
					</button>
				</td>
			</ng-container>

			<tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
			<tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>
		</table>
	</div>

	<div class="copy-summary" style="margin-bottom: 2rem">
		<mat-chip-set aria-label="Sumário de cópias">
			<mat-chip>Arquivos adicionados: 1</mat-chip>
			<mat-chip>Contagem de folhas: 123</mat-chip>
		</mat-chip-set>
	</div>

	<div class="term-input">
		<p>3. Defina o prazo de entrega</p>
		<mat-form-field>
			<mat-label>Selecione um prazo</mat-label>
			<mat-select>
				@for (time of times; track time) {
				<mat-option [value]="time">{{ time }} horas</mat-option>
				}
			</mat-select>
		</mat-form-field>
	</div>

	<div class="confirm-button">
		<button type="button" mat-flat-button>Enviar Solicitação</button>
	</div>
</form>
